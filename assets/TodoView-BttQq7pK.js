import{e as y,c as i,o as d,a as e,F as w,r as N,t as k,b as S,d as L,l as V,f as T,g as z,h as A,w as B,v as q,n as b,k as D}from"./index-BUmTTfRd.js";import{a as f}from"./index-NIGUFBhG.js";const E={class:"todoList_items"},I={class:"todoList_item"},F={class:"todoList_label"},O=["checked","onChange"],P=["onClick"],R={class:"todoList_statistics"},U={key:0},j={key:1},G={key:2},H={__name:"TodoList",props:{todoList:{type:Array,required:!0},completedCount:{type:Number,required:!0},incompleteCount:{type:Number,required:!0},tabMode:{type:String,required:!1}},emits:["emit-status-checkbox"],setup($,{emit:C}){const a=$,n=C,u=o=>{n("emit-status-checkbox",o)},c=o=>{n("emit-del-checkbox",o)},l=y(()=>a.tabMode=="completed"?a.todoList.filter(o=>o.status==!0):a.tabMode=="pending"?a.todoList.filter(o=>o.status==!1):a.todoList);return(o,g)=>(d(),i("div",E,[e("ul",I,[(d(!0),i(w,null,N(l.value,r=>(d(),i("li",{key:r.id},[e("label",F,[e("input",{class:"todoList_input",type:"checkbox",value:"true",checked:r.status,onChange:p=>u(r.id)},null,40,O),e("span",null,k(r.content),1)]),e("a",{href:"#",onClick:p=>c(r.id)},[...g[0]||(g[0]=[e("i",{class:"fa fa-times"},null,-1)])],8,P)]))),128))]),e("div",R,[l.value.length>0?(d(),i("p",U,k(a.incompleteCount)+" 個待完成項目",1)):S("",!0),l.value.length>0?(d(),i("p",j,k(a.completedCount)+" 個已完成項目",1)):(d(),i("p",G,"目前尚無待辦事項"))])]))}},J={id:"todoListPage",class:"bg-half"},K={class:"conatiner todoListPage vhContainer"},Q={class:"todoList_Content"},W={class:"inputBox"},X={class:"todoList_list"},Y={class:"todoList_tab"},_="https://todolist-api.hexschool.io/",et={__name:"TodoView",setup($){const C=y(()=>v.value.filter(t=>t.status==!0).length),a=y(()=>v.value.filter(t=>t.status==!1).length),n=L("all"),u=s=>{n.value=s};V(async()=>{l()});const c=document.cookie.replace(/(?:^|.*;\s*)userToken\s*=\s*([^;]*).*$/i,"$1"),l=async()=>{try{const s=await f.get(`${_}todos/`,{headers:{Authorization:c}});s.data.status&&(v.value=s.data.data)}catch(s){const t=s.response.data&&s.response.data.message?s.response.data.message:"未知的錯誤";alert(t)}},o=L({content:""}),g=async()=>{try{(await f.post(`${_}todos/`,{content:o.value.content},{headers:{Authorization:c}})).data.status&&(alert("新增代辦項目成功"),l())}catch(s){const t=s.response.data&&s.response.data.message?s.response.data.message:"未知的錯誤";alert(t)}},r=async s=>{try{(await f.delete(`${_}todos/${s}`,{headers:{Authorization:c}})).data.status&&(alert("刪除代辦項目成功"),l())}catch(t){const m=t.response.data&&t.response.data.message?t.response.data.message:"未知的錯誤";alert(m)}};let p=!1;const x=s=>{p||(p=!0,setTimeout(()=>{M(s),p=!1},1e3))},M=async s=>{try{(await f.patch(`${_}todos/${s}/toggle`,{},{headers:{Authorization:c}})).data.status&&(alert("更新代辦項目狀態成功"),l())}catch(t){const m=t.response.data&&t.response.data.message?t.response.data.message:"未知的錯誤";alert(m)}},v=L([]);return(s,t)=>{const m=A("RouterLink");return d(),i("div",J,[e("nav",null,[t[7]||(t[7]=e("h1",null,[e("a",{href:"#"},"ONLINE TODO LIST")],-1)),e("ul",null,[t[6]||(t[6]=e("li",{class:"todo_sm"},[e("a",{href:"#"},[e("span",null,"王小明的代辦")])],-1)),e("li",null,[T(m,{to:"/login",class:"formControls_btnLink"},{default:z(()=>[...t[5]||(t[5]=[D("登出",-1)])]),_:1})])])]),e("div",K,[e("div",Q,[e("div",W,[B(e("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":t[0]||(t[0]=h=>o.value.content=h)},null,512),[[q,o.value.content]]),e("a",{href:"#",onClick:t[1]||(t[1]=h=>g())},[...t[8]||(t[8]=[e("i",{class:"fa fa-plus"},null,-1)])])]),e("div",X,[e("ul",Y,[e("li",null,[e("a",{href:"#",onClick:t[2]||(t[2]=h=>u("all")),class:b(n.value=="all"?"active":"")},"全部",2)]),e("li",null,[e("a",{href:"#",onClick:t[3]||(t[3]=h=>u("pending")),class:b(n.value=="pending"?"active":"")},"待完成",2)]),e("li",null,[e("a",{href:"#",onClick:t[4]||(t[4]=h=>u("completed")),class:b(n.value=="completed"?"active":"")},"已完成",2)])]),T(H,{todoList:v.value,completedCount:C.value,incompleteCount:a.value,tabMode:n.value,onEmitStatusCheckbox:x,onEmitDelCheckbox:r},null,8,["todoList","completedCount","incompleteCount","tabMode"])])])])])}}};export{et as default};
